{"version":3,"sources":["GeoPicker.es6"],"names":[],"mappings":"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","file":"GeoPicker.js","sourcesContent":["// import * as JSON from 'json5';\r\n\r\n\r\njQuery.fn.GeoPicker = function ( params ) {\r\n\tif ( !this.length ) return this;\r\n\r\n\tlet picker = {\r\n\t\t\t/** Elements */\r\n\t\t\twrapper: false,\r\n\t\t\tticker: false,\r\n\t\t\tlist: false,\r\n\t\t\tmap: false,\r\n\t\t\tform: false,\r\n\t\t\toverlay: false,\r\n\t\t\thistory: false,\r\n\t\t\tsuggest: false,\r\n\t\t\tmarkers: {},\r\n\r\n\t\t\t/** Status controllers */\r\n\t\t\tmapMoved: false,\r\n\t\t\tsearchOpen: false,\r\n\t\t\tselected: false,\r\n\t\t\tautoComplete: false\r\n\r\n\t\t},\r\n\t\tel = jQuery(this),\r\n\t\tdefaults = {\r\n\t\t\tdebug: false,\r\n\t\t\tuseGeolocation: true,\r\n\t\t\tid: 'GeoPicker',\r\n\t\t\tsource: false,\r\n\t\t\tpositions: false,\r\n\t\t\tlistLength: 5,\r\n\t\t\tcloseOnSelect: true,\r\n\t\t\tcurrentPosition: {lat: 0, lng: 0},\r\n\t\t\tmarkerIcon: window.location.origin + '/typo3conf/ext/c3baxi/Resources/Public/Icons/Hst1@2x.png',\r\n\t\t\tmarkerIconSelected: window.location.origin + '/typo3conf/ext/c3baxi/Resources/Public/Icons/Hst1_selected@2x.png' + '#selected',\r\n\t\t\tpositionIcon: window.location.origin + '/typo3conf/ext/c3baxi/Resources/Public/Icons/Position@2x.png' + '#selected',\r\n\t\t\tdefaultMapZoom : 16,\r\n\t\t\tboundsOnSelect : false,\r\n\t\t\t/** Templates */\r\n\t\t\ttemplates: {\r\n\t\t\t\twraper: '<div class=\"position_picker\"></div>',\r\n\t\t\t\tmap: '<div id=\"map\" class=\"position_picker-map\"></div>',\r\n\t\t\t\tlist: '<ul class=\"position_picker-list\"></ul>',\r\n\t\t\t\tlistItem: '<li class=\"position_picker-list_item\"></li>',\r\n\t\t\t\tpicker: '<span class=\"position_picker-picker\"></span>',\r\n\t\t\t\tcontent: '<div class=\"position_picker-content\"></div>'\r\n\t\t\t},\r\n\t\t\tlng: {\r\n\t\t\t\tbtnConfirm: 'Haltestelle wählen'\r\n\t\t\t},\r\n\t\t\tcustomSearchButtons: function () {\r\n\t\t\t},\r\n\t\t\tcustomButtons: function () {\r\n\t\t\t},\r\n\r\n\t\t\t/** Callbacks */\r\n\t\t\tonSelect: false,\r\n\t\t\tonSubmit: false\r\n\t\t},\r\n\t\tsettings = jQuery.extend({}, defaults, params);\r\n\r\n\tlet init = function () {\r\n\t\t/** load positions from source */\r\n\t\tif ( settings.source ) {\r\n\t\t\tif ( typeof settings.source === 'string' ) {\r\n\t\t\t\tsettings.positions = getPositions();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/** activate geolocation */\r\n\t\tif ( settings.useGeolocation ) {\r\n\t\t\tel.on('position-changed', updateMap);\r\n\r\n\t\t\tif ( 'geolocation' in navigator ) {\r\n\t\t\t\tnavigator.geolocation.getCurrentPosition(function ( position ) {\r\n\t\t\t\t\tsetCurrentPosition(position);\r\n\t\t\t\t\tnavigator.geolocation.watchPosition(setCurrentPosition);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/** build structure */\r\n\t\tsetup();\r\n\t};\r\n\r\n\tlet setup = function () {\r\n\t\tpicker.wrapper = jQuery(settings.templates.wraper)\r\n\t\t\t.attr('id', settings.id)\r\n\t\t\t.appendTo(el);\r\n\r\n\t\tpicker.overlay = jQuery('<div class=\"position_picker-overlay\"></div>').appendTo(picker.wrapper);\r\n\r\n\t\tif ( settings.debug ) {\r\n\t\t\tpicker.ticker = jQuery(settings.templates.picker).appendTo(picker.wrapper);\r\n\t\t\tpicker.ticker.text(settings.currentPosition.lat + ', ' + settings.currentPosition.lng);\r\n\t\t}\r\n\r\n\t\tinitMap( () => {\r\n\r\n\t\t\tpicker.content = jQuery(settings.templates.content).appendTo(picker.wrapper);\r\n\r\n\t\t\tbuildContent();\r\n\r\n\t\t});\r\n\t};\r\n\r\n\tfunction close() {\r\n\t\tel.remove();\r\n\t}\r\n\r\n\tfunction setCurrentPosition( position ) {\r\n\r\n\t\tlet newPosition = {\r\n\t\t\tlat: position.coords.latitude,\r\n\t\t\tlng: position.coords.longitude\r\n\t\t};\r\n\r\n\t\tif ( JSON.stringify(newPosition) !== JSON.stringify(settings.currentPosition) ) {\r\n\t\t\tsettings.currentPosition = newPosition;\r\n\t\t\tel.trigger('position-changed', position);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction initMap( callback = function(){}) {\r\n\r\n\t\tif ( typeof google === 'undefined' ) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t\telse {\r\n\r\n\t\t\tpicker.map = new google.maps.Map((jQuery(settings.templates.map).appendTo(picker.wrapper))[ 0 ], {\r\n\t\t\t\tcenter: settings.currentPosition,\r\n\t\t\t\tzoom: settings.defaultMapZoom,\r\n\t\t\t\tdisableDefaultUI: true,\r\n\t\t\t\tgestureHandling: 'greedy'\r\n\t\t\t});\r\n\r\n\t\t\t/** create marker for user */\r\n\t\t\tpicker.currentPosition = new google.maps.Marker({\r\n\t\t\t\tposition: settings.currentPosition,\r\n\t\t\t\tmap: picker.map,\r\n\t\t\t\ttitle: 'mein Standort',\r\n\t\t\t\ticon: settings.positionIcon + '#selected'\r\n\t\t\t});\r\n\t\t\t/** move center up */\r\n\t\t\tpicker.map.panTo(settings.currentPosition);\r\n\t\t\tpicker.map.panBy(0, 100);\r\n\r\n\t\t\t/** set control attribute */\r\n\t\t\tpicker.map.addListener('drag', function ( evt ) {\r\n\t\t\t\tpicker.mapMoved = true;\r\n\t\t\t});\r\n\r\n\t\t\t/** create marker for positions */\r\n\t\t\tsettings.positions.then(function ( positions ) {\r\n\t\t\t\tpicker.markers = {};\r\n\r\n\t\t\t\tObject.keys(positions).map(function ( key ) {\r\n\t\t\t\t\tlet marker = new google.maps.Marker({\r\n\t\t\t\t\t\t// map: picker.map,\r\n\t\t\t\t\t\tmap: null,\r\n\t\t\t\t\t\tposition: new google.maps.LatLng(...positions[ key ].latLng.split(',')),\r\n\t\t\t\t\t\ttitle: positions[ key ].name,\r\n\t\t\t\t\t\tkey: key,\r\n\t\t\t\t\t\tdata: positions[ key ],\r\n\t\t\t\t\t\ticon: settings.markerIcon,\r\n\t\t\t\t\t\tanimation: google.maps.Animation.DROP\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmarker.addListener('click', select);\r\n\t\t\t\t\tpicker.markers[ key ] = marker;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet showVisibleMarkers = ( evt ) => {\r\n\t\t\t\t\t// console.log(showVisibleMarkers, evt);\r\n\t\t\t\t\tif ( picker.map ) {\r\n\t\t\t\t\t\tlet bounds = picker.map.getBounds();\r\n\t\t\t\t\t\tif ( typeof bounds != 'undefined' ) {\r\n\t\t\t\t\t\t\tObject.values(picker.markers).forEach(( item ) => {\r\n\t\t\t\t\t\t\t\tif ( bounds.contains(item.position) && item.map !== picker.map ) {\r\n\r\n\t\t\t\t\t\t\t\t\titem.setMap(picker.map);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if ( false === bounds.contains(item.position) ) {\r\n\t\t\t\t\t\t\t\t\titem.setMap(null);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t/** toggle markers if in/out viewport */\r\n\t\t\t\tgoogle.maps.event.addListener(picker.map, 'tilesloaded', showVisibleMarkers);\r\n\t\t\t\t// google.maps.event.addListener(picker.map, 'idle', showVisibleMarkers );\r\n\t\t\t\tcallback();\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction switchAnimation() {\r\n\t\tObject.values(picker.markers)\r\n\t\t      .forEach(( mark ) =>\r\n\t\t\t      setTimeout(mark.setAnimation(google.maps.Animation.BOUNCE), 50)\r\n\t\t      );\r\n\t}\r\n\r\n\tlet updateMap = function () {\r\n\t\tif ( settings.debug ) {\r\n\t\t\tpicker.ticker.text(Number(settings.currentPosition.lat).toPrecision(8) + ', ' + Number(settings.currentPosition.lng).toPrecision(8));\r\n\t\t}\r\n\r\n\r\n\t\tif ( picker.map || picker.currentPosition ) {\r\n\t\t\t// console.log( picker.mapMoved );\r\n\t\t\tif ( picker.map && !picker.mapMoved ) { // center the map, if user not dragged\r\n\t\t\t\tpicker.map.panTo(settings.currentPosition);\r\n\t\t\t\tpicker.map.panBy(0, 100);\r\n\t\t\t}\r\n\r\n\t\t\t/** update user position */\r\n\t\t\tif ( picker.currentPosition ) {\r\n\t\t\t\tpicker.currentPosition.setPosition(settings.currentPosition);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tlet buildContent = function () {\r\n\t\tpicker.content.html(null);\r\n\t\tpicker.history = jQuery('<div class=\"position_picker-list position_picker-list--history\"><h3>Verlauf</h3></div>');\r\n\t\tif ( typeof Store !== undefined ) {\r\n\t\t\tlet history = Store.get('history');\r\n\t\t}\r\n\t\tbuildSearch();\r\n\t\tbuildSelected();\r\n\t\tpicker.search.show();\r\n\t};\r\n\r\n\tlet buildSearch = function () {\r\n\r\n\t\tpicker.search = jQuery('<div class=\"position_picker-content position_picker-content--search\">').appendTo(picker.wrapper).hide();\r\n\r\n\t\tpicker.field = jQuery('<input type=\"text\" class=\"input-field\" name=\"geoPicker_search\" placeholder=\"Haltestelle suchen\" />')\r\n\t\t\t.appendTo(picker.search)\r\n\t\t\t.on('focus', function ( evt ) {\r\n\t\t\t\tif ( !picker.searchOpen ) {\r\n\t\t\t\t\topenSearch();\r\n\t\t\t\t\t// getSupportActionBar().hide();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.on('input', function ( evt ) {\r\n\t\t\t\tif ( picker.autoComplete === false ) {\r\n\t\t\t\t\tpicker.autoComplete = true;\r\n\t\t\t\t\tpicker.history.hide();\r\n\t\t\t\t\tpicker.suggest = jQuery('<div class=\"position_picker-list position_picker-list--suggest\"><h3>Gefundene Haltestellen</h3></div>').insertAfter(picker.field);\r\n\t\t\t\t\tpicker.suggestList = jQuery('<ul >').insertAfter(picker.suggest.find('h3'));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet searchWord = evt.target.value,\r\n\t\t\t\t\t\tlist = {}, found = {};\r\n\t\t\t\t\tif ( settings.source ) {\r\n\t\t\t\t\t\tpicker.suggestList.empty();\r\n\r\n\t\t\t\t\t\tsettings.positions.then(( positions ) => {\r\n\r\n\t\t\t\t\t\t\tfound = Object.filter(positions,\r\n\t\t\t\t\t\t\t\t( el, idx ) => {\r\n\t\t\t\t\t\t\t\t\tif ( el.name.toLowerCase().includes(searchWord.toLowerCase()) ) {\r\n\t\t\t\t\t\t\t\t\t\tlet latLng = el.latLng.split(','),\r\n\t\t\t\t\t\t\t\t\t\t\tposition = new google.maps.LatLng(latLng[ 0 ], latLng[ 1 ]);\r\n\t\t\t\t\t\t\t\t\t\tel.key = idx;\r\n\t\t\t\t\t\t\t\t\t\tel.distance = google.maps.geometry.spherical.computeDistanceBetween(position, picker.currentPosition.position);\r\n\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tfound = Object.values(found)\r\n\t\t\t\t\t\t\t              .sort(( a, b ) => a.distance - b.distance)\r\n\t\t\t\t\t\t\t              .slice(0, 8);\r\n\r\n\t\t\t\t\t\t\tjQuery.each(found, function ( idx, item ) {\r\n\t\t\t\t\t\t\t\tlet res = jQuery('<li>').html(item.name);\r\n\t\t\t\t\t\t\t\tif ( item.distance ) {\r\n\t\t\t\t\t\t\t\t\tres.append(jQuery('<small>').text(formatDistance(item.distance)));\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tres.on('click', function ( evt ) {\r\n\t\t\t\t\t\t\t\t\tselect(jQuery.extend(evt, {data: item})); //.bind(this);\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tpicker.suggestList.append(res);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// else {\r\n\t\t\t\t\t// \tlist = settings.positions;\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\tpicker.search.append(settings.customSearchButtons(picker, el, select));\r\n\t};\r\n\r\n\tfunction buildSelected() {\r\n\t\tpicker.selectedBlock = jQuery('<div>').appendTo(picker.content).hide();\r\n\t}\r\n\r\n\tfunction openSearch() {\r\n\t\tpicker.overlay.show();\r\n\t\t// picker.content\r\n\t\tpicker.searchOpen = true;\r\n\t\tlet closeBtn = jQuery('<span class=\"position_picker-content-close\">')\r\n\t\t\t.hide()\r\n\t\t\t.appendTo(picker.search)\r\n\t\t\t.on('click', closeSearch);\r\n\t\tpicker.search.toggleClass('is-extended', true).removeClass('slidedown').addClass('slideup');\r\n\t\tcloseBtn.show(400);\r\n\r\n\t\t// picker.history.insertAfter(picker.field);\r\n\r\n\t}\r\n\r\n\tlet closeSearch = function () {\r\n\t\tpicker.content.toggleClass('is-extended', false)\r\n\t\t      .removeClass('slideup').addClass('slidedown')\r\n\t\t      .find('span.position_picker-content-close')\r\n\t\t      .hide();\r\n\r\n\t\tpicker.history.hide();\r\n\t\tpicker.overlay.hide();\r\n\t\tif ( picker.suggest )\r\n\t\t\tpicker.suggest.html(null);\r\n\t\tif ( picker.field )\r\n\t\t\tpicker.field.val(null);\r\n\t\tpicker.searchOpen = picker.autoComplete = false;\r\n\t};\r\n\r\n\t// function buildList() {\r\n\t//\r\n\t// \tlet list = settings.positions,\r\n\t// \t\tcnt = 0;\r\n\t// \tjQuery.each(list, function ( idx, item ) {\r\n\t//\r\n\t// \t\tlet listItem = jQuery(settings.templates.listItem)\r\n\t// \t\t\t.text(item.name)\r\n\t// \t\t\t.appendTo(picker.list);\r\n\t//\r\n\t// \t\tlistItem.data({id: idx, coords: item.latLng});\r\n\t// \t\tcnt++;\r\n\t// \t\tif ( cnt === settings.listLength )\r\n\t// \t\t\treturn false;\r\n\t// \t});\r\n\t// \tpicker.list.removeClass('is-loading');\r\n\t// }\r\n\r\n\tfunction select( evt ) {\r\n\r\n\t\tif ( typeof this !== 'undefined' ) {\r\n\t\t\t/** mark as selected */\r\n\t\t\t// console.log( picker.selected !== false , typeof picker.selected.setIcon === 'function'  );\r\n\t\t\tif ( picker.selected !== false && typeof picker.selected.setIcon === 'function' ) {\r\n\t\t\t\tpicker.selected.setIcon(window.location.origin + '/typo3conf/ext/c3baxi/Resources/Public/Icons/Hst1@2x.png');\r\n\t\t\t}\r\n\t\t\tpicker.selected = this;\r\n\t\t\tthis.setIcon(window.location.origin + '/typo3conf/ext/c3baxi/Resources/Public/Icons/Hst1_selected@2x.png' + '#selected');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpicker.selected = evt.data;\r\n\t\t\tlet latLng = evt.data.latLng.split(',');\r\n\t\t\tpicker.selected = picker.markers[evt.data.key];\r\n\t\t\tif( picker.selected.setIcon( settings.markerIconSelected ) )\r\n\t\t\tcloseSearch();\r\n\t\t}\r\n\r\n\t\tif( settings.boundsOnSelect === true ) {\r\n\t\t\tlet bounds = new google.maps.LatLngBounds();\r\n\r\n\t\t\tbounds.extend( picker.selected.position );\r\n\t\t\tbounds.extend( picker.currentPosition.position );\r\n\t\t\tpicker.map.fitBounds( bounds );\r\n\t\t\tpicker.map.panBy(0, 100);\r\n\t\t}\r\n\r\n\t\t// console.log( picker.selected ,typeof this !== 'undefined' );\r\n\r\n\t\tel.trigger('selected', picker.selected);\r\n\r\n\t\tif ( settings.closeOnSelect ) {\r\n\t\t\tif ( settings.onSubmit !== false ) {\r\n\t\t\t\tsettings.onSubmit(picker.selected, picker);\r\n\t\t\t}\r\n\t\t\tclose();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpicker.map.setZoom( picker.map.getZoom() + 1 );\r\n\t\t\tif ( settings.onSelect !== false ) {\r\n\t\t\t\tsettings.onSelect(picker.selected, picker);\r\n\t\t\t}\r\n\t\t\tshowSelected();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction showSelected() {\r\n\t\tpicker.search.hide();\r\n\t\tpicker.selectedBlock.hide().html(null);\r\n\r\n\r\n\t\t// picker.content\r\n\t\t//       .removeClass('is-extended')\r\n\t\t//       .toggleClass('is-selected', true);\r\n\r\n\t\tpicker.selectedBlock = jQuery('<div class=\"position_picker-content position_picker-content--selected\">')\r\n\t\t\t.appendTo( picker.wrapper );\r\n\t\t/** Title */\r\n\t\tlet title = jQuery('<h3>').html(picker.selected.title);\r\n\t\ttitle.appendTo(picker.selectedBlock);\r\n\t\t/** Subtitle */\r\n\t\tlet subTitle = jQuery('<p>').addClass('subtitle');\r\n\t\tsubTitle.appendTo(picker.selectedBlock);\r\n\r\n\t\tlet distance = google.maps.geometry.spherical.computeDistanceBetween(picker.selected.position, picker.currentPosition.position);\r\n\t\tif ( distance ) {\r\n\t\t\tsubTitle.append(jQuery('<span>').html(Math.round(distance).toFixed(0).replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1 ') + ' m'));\r\n\t\t}\r\n\r\n\t\t/** confirm and close */\r\n\t\tlet confirm = jQuery('<button>').addClass('btn btn--next').html(settings.lng.btnConfirm + ' ' +\r\n\t\t\t'<svg class=\"icon\" width=\"30\" height=\"30\"><use xlink:href=\"#Pfeil_R\"></use></svg>');\r\n\r\n\t\tconfirm.appendTo(picker.selectedBlock);\r\n\t\tconfirm.on('click', function () {\r\n\t\t\tif ( settings.onSubmit !== false ) {\r\n\t\t\t\tsettings.onSubmit(picker.selected, picker);\r\n\t\t\t}\r\n\r\n\t\t\tclose();\r\n\t\t});\r\n\r\n\t\t/** Other Buttons and Controls */\r\n\t\tlet controls = jQuery('<div class=\"controls\">').appendTo(picker.selectedBlock);\r\n\r\n\t\tcontrols.append( settings.customButtons(picker) );\r\n\r\n\t\tlet cancelBtn = jQuery('<span class=\"controls-btn\">')\r\n\t\t\t.html('<span class=\"btn btn--marble has-icon\">' +\r\n\t\t\t\t'<svg class=\"icon\" width=\"24\" height=\"24\">' +\r\n\t\t\t\t'<use xlink:href=\"#Abbrechen\"></use></svg>' +\r\n\t\t\t\t'</span> Abbrechen'\r\n\t\t\t)\r\n\t\t\t.appendTo(controls);\r\n\r\n\t\tcancelBtn.on('click', function () {\r\n\r\n\t\t\tif( typeof picker.selected.setIcon === 'function' ) {\r\n\t\t\t\tpicker.selected.setIcon( settings.markerIcon );\r\n\t\t\t}\r\n\t\t\tpicker.map.setZoom( settings.defaultMapZoom );\r\n\t\t\tpicker.selected = false;\r\n\t\t\tpicker.content.toggleClass('is-selected', false);\r\n\t\t\tpicker.selectedBlock.hide();\r\n\r\n\t\t\tpicker.search.show(300);\r\n\t\t});\r\n\r\n\t\tif ( picker.map ) {\r\n\t\t\tpicker.map.panTo(picker.selected.position);\r\n\t\t\tpicker.map.panBy(0, 100);\r\n\t\t}\r\n\t\tlet contentHeight = (picker.selectedBlock.height() + parseInt(picker.content.css('padding-top')) + parseInt(picker.content.css('padding-bottom')));\r\n\t\tpicker.selectedBlock[0].style.setProperty('--content-height', contentHeight + 'px');\r\n\r\n\t\t// picker.content.slideUp();\r\n\t\t// picker.selectedBlock.slideDown();\r\n\r\n\t}\r\n\r\n\tfunction formatDistance( dst, precision = 0 ) {\r\n\t\tlet units = [ 'm', 'km', 'etwas ist falsch :D' ],\r\n\t\t\tuIdx = 0;\r\n\r\n\t\twhile ( dst > 1000 ) {\r\n\t\t\tdst = dst / 1000;\r\n\t\t\tuIdx++;\r\n\t\t}\r\n\r\n\t\treturn Math.round(dst, precision).toString() + ' ' + units[ uIdx ];\r\n\t}\r\n\r\n\tfunction getPositions() {\r\n\t\treturn new Promise(( resolve, reject ) => {\r\n\t\t\tjQuery.ajax({\r\n\t\t\t\t      url: settings.source,\r\n\t\t\t\t      method: 'POST',\r\n\t\t\t\t      data: {\r\n\t\t\t\t\t      tx_c3baxi_baxisuche: {\r\n\t\t\t\t\t\t      'ignoreZone': ignoreZone\r\n\t\t\t\t\t      }\r\n\t\t\t\t      }\r\n\t\t\t      })\r\n\t\t\t      .then(function ( response ) {\r\n\t\t\t\t      resolve(response);\r\n\t\t\t      })\r\n\t\t\t      .catch(function ( error ) {\r\n\t\t\t\t      reject([]);\r\n\t\t\t      });\r\n\t\t});\r\n\t}\r\n\r\n\tinit();\r\n};"]}